<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barista Dashboard - SHAZAM</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="barista-style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js"></script>
    <script>
        // Initialize Firebase with error handling
        console.log('Firebase scripts loading...');
        
        const firebaseConfig = {
            apiKey: "AIzaSyCnoVYQ_BgOSNeVuJPE0hF92beCrWhpoPE",
            authDomain: "shazam-coffee.firebaseapp.com",
            projectId: "shazam-coffee",
            storageBucket: "shazam-coffee.firebasestorage.app",
            messagingSenderId: "303645613348",
            appId: "1:303645613348:web:fd463f95c4bb95d16fa7b1"
        };
        
        // Wait for firebase to be available
        let initAttempts = 0;
        const initFirebase = setInterval(() => {
            if (typeof firebase !== 'undefined' && firebase.apps !== undefined) {
                clearInterval(initFirebase);
                try {
                    if (!firebase.apps.length) {
                        firebase.initializeApp(firebaseConfig);
                    }
                    window.firebaseDB = firebase.database();
                    console.log('âœ… Firebase initialized successfully');
                } catch (error) {
                    console.error('Firebase init error:', error);
                    window.firebaseDB = null;
                }
            } else {
                initAttempts++;
                if (initAttempts > 100) {
                    clearInterval(initFirebase);
                    console.warn('âš ï¸ Firebase CDN not loaded. Using offline mode (localStorage). The app will still work fine!');
                    window.firebaseDB = null;
                }
            }
        }, 100);
    </script>
</head>
<body>
    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">â˜•</div>
                <h1>Staff Access</h1>
            </div>
            
            <!-- Role Selection -->
            <div class="role-selector" id="roleSelector">
                <p style="text-align: center; margin-bottom: 20px; color: #5c3d2e; font-weight: bold;">Select Your Role</p>
                <button type="button" class="role-btn" onclick="selectRole('barista')">ğŸ‘¨â€ğŸ’¼ Barista</button>
                <button type="button" class="role-btn" onclick="selectRole('manager')">ğŸ“Š Manager</button>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" onsubmit="handleLogin(event)" style="display: none;">
                <!-- Barista Login Info -->
                <div id="baristaLoginInfo" style="background: linear-gradient(135deg, #f5e6d3, #fff); padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #d4a574; display: none;">
                    <p style="margin: 0 0 10px 0; color: #3e2723; font-weight: bold;">ğŸ‘¨â€ğŸ’¼ Barista Login</p>
                    <p style="margin: 0 0 8px 0; color: #666; font-size: 0.9rem;">Use the <strong>name created by the manager</strong></p>
                    <p style="margin: 0; color: #666; font-size: 0.85rem;">Password & Keyword: Contact your manager</p>
                </div>
                
                <div class="form-group">
                    <label for="username">ğŸ‘¨â€ğŸ’¼ Your User Name *</label>
                    <input type="text" id="username" placeholder="Use your name as created by manager" required>
                    <small style="color: #999; display: block; margin-top: 5px;">Must match the name registered in the system</small>
                </div>
                <div class="form-group">
                    <label for="password">ğŸ” Password:</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <div class="form-group">
                    <label for="keyword">ğŸ”‘ Keyword:</label>
                    <input type="password" id="keyword" placeholder="Enter keyword" required>
                </div>
                <button type="submit" class="login-btn">Login</button>
            </form>
            <div class="login-error" id="loginError"></div>
            <div class="login-footer">
                <a href="menu.html" class="home-btn">ğŸ  Back to Menu</a>
                <button type="button" class="back-role-btn" id="backRoleBtn" onclick="backToRoleSelection()" style="display: none;">â† Back</button>
            </div>
        </div>
    </div>

    <div class="dashboard-container" id="dashboardContainer" style="display: none;">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="coffee-icon">â˜•</div>
                    <div>
                        <h1>Barista Dashboard</h1>
                        <p class="subtitle">SHAZAM Barista - USAFI COFFEE Shop</p>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-card">
                        <span class="stat-number" id="totalOrders">0</span>
                        <span class="stat-label">Total Orders</span>
                    </div>
                    <div class="stat-card active-stat">
                        <span class="stat-number" id="activeOrders">0</span>
                        <span class="stat-label">Active</span>
                    </div>
                    <div class="stat-card completed-stat">
                        <span class="stat-number" id="completedOrders">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Controls -->
        <div class="controls-bar">
            <div class="controls-left">
                <button class="control-btn" id="refreshBtn">
                    ğŸ”„ Refresh
                </button>
                <button class="control-btn" id="clearCompletedBtn">
                    ğŸ—‘ï¸ Clear Completed
                </button>
            </div>
            <div class="controls-right">
                <button class="control-btn logout-btn" onclick="logoutBarista()">
                    ğŸšª Logout
                </button>
                <a href="menu.html" class="control-btn back-btn">
                    â† Back to Menu
                </a>
            </div>
        </div>

        <!-- Orders Grid -->
        <main class="orders-section">
            <div id="ordersContainer">
                <!-- Orders will be dynamically inserted here -->
            </div>
            <div class="empty-state" id="emptyState">
                <div class="empty-icon">ğŸ“‹</div>
                <h2>No Orders Yet</h2>
                <p>Orders from customers will appear here in real-time</p>
            </div>
        </main>

        <!-- Footer -->
        <footer style="background: linear-gradient(135deg, #3e2723, #2c1810); padding: 20px; text-align: center; margin-top: 30px; border-top: 3px solid #d4a574;">
            <p class="signature">Made by AJM digital solution</p>
        </footer>
    </div>

    <!-- MANAGER DASHBOARD -->
    <div class="manager-dashboard" id="managerDashboard" style="display: none;">
        <!-- Manager Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="coffee-icon">â˜•</div>
                    <div>
                        <h1>Manager Dashboard</h1>
                        <p class="subtitle">SHAZAM Coffee Shop - Order Management</p>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-card">
                        <span class="stat-number" id="totalOrdersManager">0</span>
                        <span class="stat-label">Total Orders</span>
                    </div>
                    <div class="stat-card active-stat">
                        <span class="stat-number" id="pendingOrdersManager">0</span>
                        <span class="stat-label">Pending</span>
                    </div>
                    <div class="stat-card completed-stat">
                        <span class="stat-number" id="completedOrdersManager">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Manager Controls -->
        <div class="controls-bar">
            <div class="controls-left">
                <button class="control-btn" id="manageBaristaBtn">ğŸ‘¨â€ğŸ’¼ Manage Baristas</button>
                <button class="control-btn" id="refreshManagerBtn">ğŸ”„ Refresh</button>
            </div>
            <div class="controls-right">
                <button class="control-btn logout-btn" onclick="logoutManager()">ğŸšª Logout</button>
                <a href="menu.html" class="control-btn back-btn">â† Back to Menu</a>
            </div>
        </div>

        <!-- Manager Content -->
        <main class="orders-section">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; padding: 20px;">
                <!-- Orders List -->
                <div>
                    <h2 style="color: #3e2723; margin-bottom: 15px;">ğŸ“‹ All Orders</h2>
                    <div id="managerOrdersContainer">
                        <!-- Orders will be listed here -->
                    </div>
                </div>
                <!-- Baristas List -->
                <div>
                    <h2 style="color: #3e2723; margin-bottom: 15px;">ğŸ‘¥ Baristas</h2>
                    <div id="baristasListContainer" style="border: 2px solid #d4a574; border-radius: 10px; padding: 15px; background: rgba(255,255,255,0.8);">
                        <!-- Baristas will be listed here -->
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer style="background: linear-gradient(135deg, #3e2723, #2c1810); padding: 20px; text-align: center; margin-top: 30px; border-top: 3px solid #d4a574;">
            <p class="signature">Made by AJM digital solution</p>
        </footer>
    </div>

    <!-- Barista Management Modal -->
    <div class="modal" id="baristaManagementModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #5c3d2e, #3e2723); color: #ffd89b; padding: 20px; border-radius: 15px 15px 0 0;">
                <h2 style="margin: 0; font-size: 1.5rem;">ğŸ‘¥ Manage Baristas</h2>
                <span class="close-modal" id="closeBaristaModal" style="color: #ffd89b; font-size: 2rem; cursor: pointer;">&times;</span>
            </div>
            <div class="modal-body" style="padding: 25px;">
                <!-- Add New Barista Section -->
                <div style="background: linear-gradient(135deg, #f5e6d3, #fff); padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 2px solid #d4a574;">
                    <h3 style="margin: 0 0 15px 0; color: #3e2723; font-size: 1.1rem;">â• Add New Barista</h3>
                    <input type="text" id="baristaNameInput" placeholder="Enter barista name..." style="width: 100%; padding: 12px; margin-bottom: 12px; border: 2px solid #d4a574; border-radius: 8px; font-family: 'Dancing Script', cursive; font-size: 1rem; box-sizing: border-box;">
                    <button onclick="addBarista()" style="width: 100%; padding: 12px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Dancing Script', cursive; font-size: 1rem; transition: all 0.3s ease;">âœ“ Add Barista</button>
                </div>

                <!-- Divider -->
                <div style="text-align: center; margin: 25px 0; color: #999;">
                    <span style="background: white; padding: 0 10px;">or</span>
                    <hr style="border: 1px solid #d4a574; margin-top: -15px;">
                </div>

                <!-- Active Baristas List -->
                <div>
                    <h3 style="margin: 0 0 15px 0; color: #3e2723; font-size: 1.1rem;">ğŸ‘¥ Active Baristas</h3>
                    <div id="baristaListInModal" style="max-height: 300px; overflow-y: auto;">
                        <div style="text-align: center; color: #999; padding: 20px;">Loading baristas...</div>
                    </div>
                </div>

                <!-- Modal Footer with Cancel -->
                <div style="margin-top: 25px; display: flex; gap: 10px; border-top: 2px solid #e0d0b8; padding-top: 15px;">
                    <button onclick="document.getElementById('baristaManagementModal').style.display = 'none';" style="flex: 1; padding: 12px; background: #999; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Dancing Script', cursive; font-size: 1rem; transition: all 0.3s ease;">âœ• Cancel</button>
                    <button onclick="closeBaristaManagementModal()" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #2196F3, #1976D2); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Dancing Script', cursive; font-size: 1rem; transition: all 0.3s ease;">âœ“ Done</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Assignment Modal -->
    <div class="modal" id="orderAssignmentModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #5c3d2e, #3e2723); color: #ffd89b; padding: 20px; border-radius: 15px 15px 0 0;">
                <h2 style="margin: 0; font-size: 1.5rem;">ğŸ“‹ Assign Order to Barista</h2>
                <span class="close-modal" id="closeAssignmentModal" style="color: #ffd89b; font-size: 2rem; cursor: pointer;">&times;</span>
            </div>
            <div class="modal-body" style="padding: 25px;">
                <!-- Order Info Card -->
                <div id="assignmentOrderInfo" style="margin-bottom: 20px; padding: 20px; background: linear-gradient(135deg, #f5e6d3, #fff); border: 2px solid #d4a574; border-radius: 12px; border-left: 5px solid #d4a574;">
                    <!-- Order info will be here -->
                </div>
                
                <!-- Barista Selection Section -->
                <div style="background: linear-gradient(135deg, #f9f1e6, #fff); padding: 20px; border-radius: 12px; border: 2px solid #e8d7c3;">
                    <label style="font-weight: bold; color: #3e2723; display: block; margin-bottom: 12px; font-size: 1.05rem;">ğŸ‘¨â€ğŸ’¼ Select Barista to Assign:</label>
                    <select id="baristaAssignmentSelect" style="width: 100%; padding: 14px; margin-bottom: 20px; border: 2px solid #d4a574; border-radius: 8px; font-family: 'Dancing Script', cursive; font-size: 1rem; background: white; color: #3e2723; cursor: pointer; transition: all 0.3s ease;">
                        <option value="">ğŸ‘¨â€ğŸ’¼ Choose a barista...</option>
                    </select>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 10px; margin-top: 25px; border-top: 2px solid #e0d0b8; padding-top: 20px;">
                    <button onclick="document.getElementById('orderAssignmentModal').style.display = 'none';" style="flex: 1; padding: 14px; background: #999; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Dancing Script', cursive; font-size: 1rem; transition: all 0.3s ease;">âœ• Cancel</button>
                    <button onclick="confirmAssignment()" style="flex: 1; padding: 14px; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Dancing Script', cursive; font-size: 1rem; transition: all 0.3s ease;">âœ“ Assign Order</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="modal" id="orderDetailsModal">
        <div class="modal-content order-details-content">
            <div class="modal-header">
                <h2>Order Details</h2>
                <span class="close-modal" id="closeDetailsModal">&times;</span>
            </div>
            <div class="modal-body" id="orderDetailsBody">
                <!-- Order details will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Notification Sound -->
    <audio id="notificationSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBSh+zPLaizsIHGm98OScTgwPUKXh8LRgGwU7k9vzzn4yBQ==" type="audio/wav">
    </audio>

    <script src="staff-script.js"></script>
</body>
</html>
